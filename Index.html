<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>FNAF 2 Paint Edition - TRTF Style</title>
    <style>
        body { background: #000; color: white; font-family: 'Courier New', Courier, monospace; overflow: hidden; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        canvas { border: 4px solid #333; background: #000; image-rendering: pixelated; }
        #ui { position: absolute; top: 10px; left: 10px; pointer-events: none; }
    </style>
</head>
<body>

<canvas id="gameCanvas" width="800" height="600"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// --- ESTADO DEL JUEGO ---
let gameState = "MENU"; // MENU, GAME, SHOP, EXTRAS, GAMEOVER
let energy = 100;
let flashLight = true;
let camOpen = false;
let puppetMusic = 100;
let puppetLives = 2;
let bbActive = false;
let coins = localStorage.getItem("fnaf_coins") ? parseInt(localStorage.getItem("fnaf_coins")) : 0;
let inventory = JSON.parse(localStorage.getItem("fnaf_inventory")) || [];

// --- BASE DE DATOS PERSONAJES (Estilo TRTF 2 / Paint) ---
const animatronics = [
    "Toy Freddy", "Toy Bonnie", "Toy Chica", "Mangle", 
    "W. Foxy", "W. Bonnie", "W. Chica", "W. Freddy", "BB", "Puppet"
];

// --- FUNCIONES DE DIBUJO ESTILO PAINT ---
function drawPaintCharacter(name, x, y, size, isPlush = false) {
    ctx.lineWidth = 3;
    ctx.strokeStyle = "white";
    // Cabeza cuadrada/amorfa tipo Paint
    ctx.strokeRect(x, y, size, size);
    // Ojos simples
    ctx.fillStyle = "red";
    ctx.fillRect(x + 10, y + 10, 10, 10);
    ctx.fillRect(x + size - 20, y + 10, 10, 10);
    // Texto identificador
    ctx.fillStyle = "white";
    ctx.fillText(name, x, y - 5);
    if(isPlush) ctx.fillText("(TRTF 3 Style)", x, y + size + 15);
}

// --- LÓGICA DE GUARDADO AUTOMÁTICO ---
function saveGame() {
    localStorage.setItem("fnaf_coins", coins);
    localStorage.setItem("fnaf_inventory", JSON.stringify(inventory));
}

// --- BUCLE PRINCIPAL ---
function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (gameState === "MENU") {
        ctx.fillStyle = "white";
        ctx.font = "40px Arial";
        ctx.fillText("FNAF 2: PAINT RENEWAL", 150, 100);
        ctx.font = "20px Arial";
        ctx.fillText("1. JUGAR (NOCHE 1)", 300, 250);
        ctx.fillText("2. TIENDA DE PELUCHES", 300, 300);
        ctx.fillText("3. EXTRAS", 300, 350);
        ctx.fillText(`Monedas: ${coins}`, 300, 450);

    } else if (gameState === "GAME") {
        // Oficina (Dibujada en Paint)
        ctx.strokeStyle = "#555";
        ctx.strokeRect(100, 100, 600, 400); // Ventilación
        
        // Mecánica Puppet
        puppetMusic -= 0.05;
        ctx.fillStyle = "blue";
        ctx.fillRect(50, 50, puppetMusic * 2, 20);
        ctx.fillText("CAJA DE MÚSICA", 50, 45);

        if (puppetMusic <= 0) {
            if (puppetLives > 0) {
                puppetLives--;
                puppetMusic = 100;
                alert("¡Puppet te quitó una vida! Te quedan: " + puppetLives);
            } else {
                gameState = "GAMEOVER";
            }
        }

        // Mecánica BB
        if (bbActive) {
            flashLight = false;
            ctx.fillStyle = "red";
            ctx.fillText("¡BB HA INHABILITADO LA LUZ Y CÁMARAS!", 250, 550);
        }

        ctx.fillStyle = "white";
        ctx.fillText("Presiona 'C' para Cuerda | 'F' para Luz", 10, 580);
        ctx.fillText("Vidas Puppet: " + puppetLives, 650, 50);

    } else if (gameState === "SHOP") {
        ctx.fillText("TIENDA DE PELUCHES (Estilo TRTF 3)", 200, 50);
        animatronics.forEach((name, i) => {
            drawPaintCharacter(name, 50 + (i % 5) * 150, 100 + (Math.floor(i / 5) * 150), 50, true);
            ctx.fillText("Comprar: 100 FazCoins", 50 + (i % 5) * 150, 230 + (Math.floor(i / 5) * 150));
        });
        ctx.fillText("Presiona 'M' para volver al Menú", 10, 580);
    }
    
    requestAnimationFrame(gameLoop);
}

// --- CONTROLES ---
window.addEventListener("keydown", (e) => {
    if (gameState === "MENU") {
        if (e.key === "1") gameState = "GAME";
        if (e.key === "2") gameState = "SHOP";
    } else if (gameState === "GAME") {
        if (e.key.toLowerCase() === "c") puppetMusic = Math.min(100, puppetMusic + 10);
        if (e.key.toLowerCase() === "b") bbActive = !bbActive; // Simular entrada de BB
    } else if (e.key.toLowerCase() === "m") {
        gameState = "MENU";
        saveGame();
    }
});

gameLoop();
</script>
</body>
</html>
